/*!
 * Local.js v1.0
 * (c) 2020 Nguyen Thanh
 * Released under the MIT License.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).Vue=t()}(this,function(){"use strict";var local={},settings={},onEvents={},localStorage=window.localStorage||{},error=console.error.bind(console),isarr=Array.isArray;function isobj(e){return null!==e&&"object"==typeof e&&!isarr(e)}function on(e,t){isarr(onEvents[e])||(onEvents[e]=[]),onEvents[e].push(t)}function off(o,n){n?onEvents[o].forEach(function(e,t){n===e&&delete onEvents[o][t]}):onEvents[o]=[]}function once(t,o){on(t,function e(){o.apply(this,arguments),off(t,e)})}function trigger(t,o){isarr(onEvents[t])&&onEvents[t].forEach(function(e){"function"==typeof e&&e.call(null,o,localStorage[t])})}function ofType(t,e){return void 0===e||void 0===t||(isarr(e)?e:[e]).some(function(e){return null!==t&&t.constructor===e})}function defaultValue(e){var t;return isarr(e)||(e=[e]),e.some(function(e){return e==String?t="":e==Object?t={}:e==Array?t=[]:e==Boolean?t=!1:void 0}),void 0===t?new e[0]:t}function getValue(key){var val=localStorage[key],sett=settings[key];return void 0===sett?error(key+" not sign!"):(void 0!==val?(val=JSON.parse(val),val=val.isJSON?val.value:val.isBoolean?eval(val.value):JSON.stringify(val.value),ofType(val,sett.type)||(val=defaultValue(sett.type))):val=defaultValue(sett.type),val)}var keySys=["$on","$off","$watch"];function resign(a,t){return Array.isArray(a)?a.forEach(function(e){resign(e,t)}):-1<keySys.indexOf(a)?error('"'+a+'" is key sign watch. Do not use key use! You can omit the first $ character.'):(settings[a]=t||{},void Object.defineProperty(local,a,{set:function(e){if("function"==typeof e)return error("localStorage don't data is function.");var t,o=settings[a],n=!1;void 0===e&&void 0!==o.default&&(e="function"==typeof o.default?o.default():o.default,n=!0),(t=ofType(e,o.type))||error(n?"Type value default left!":"Type value left!"),("function"!=typeof o.validator||o.validator(e,localStorage[a])&&t)&&(e=JSON.stringify({value:e,isJSON:isobj(e)||isarr(e),isBoolean:"boolean"==typeof e}),localStorage[a]=e,trigger("set:"+a,JSON.parse(e).value)),ofType(getValue(a),o.type)||(local[LOCAL_ID][a]=defaultValue(o.type))},get:function(){var e=getValue(a);return trigger("get:"+a,e),e}}))}function watch(e){if(isarr(e))resign(e);else for(var t in e)(n=void 0)!==(n=isobj(e[t])?e[t]:{type:e[t]}).type&&n.type==Function||isarr(n.type)&&-1<isarr(n.type).indexOf(Function)?error("localStorage don't data is function."):(resign(t,n),void 0===getValue(t)&&("function"==typeof(o="function"==typeof n.default?n.default():n.default)?error("localStorage don't data is function in default."):local[LOCAL_ID][t]=o));var o,n}function unwatch(e){isarr(e)||(e=[e]),e.forEach(function(e){delete local[e],localStorage[e]=void 0})}return local.$on=on,local.$off=off,local.$watch=watch,local.$one=once,local});